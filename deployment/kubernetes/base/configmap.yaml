apiVersion: v1
kind: ConfigMap
metadata:
  name: enterprise-auth-config
  namespace: enterprise-auth
  labels:
    app: enterprise-auth
data:
  # Application
  NODE_ENV: "production"
  PORT: "3000"
  API_VERSION: "v1"
  
  # Database
  DB_HOST: "postgresql-service"
  DB_PORT: "5432"
  DB_NAME: "enterprise_auth"
  DB_SSL: "true"
  DB_POOL_MIN: "2"
  DB_POOL_MAX: "20"
  DB_IDLE_TIMEOUT: "30000"
  DB_CONNECTION_TIMEOUT: "5000"
  
  # Redis
  REDIS_HOST: "redis-service"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_KEY_PREFIX: "auth:"
  REDIS_CLUSTER_ENABLED: "false"
  
  # JWT
  JWT_ACCESS_TOKEN_EXPIRY: "15m"
  JWT_REFRESH_TOKEN_EXPIRY: "7d"
  JWT_ALGORITHM: "RS256"
  JWT_PRIVATE_KEY_PATH: "/app/keys/private.pem"
  JWT_PUBLIC_KEY_PATH: "/app/keys/public.pem"
  
  # Password Hashing (Argon2id)
  ARGON2_TIME_COST: "2"
  ARGON2_MEMORY_COST: "65536"
  ARGON2_PARALLELISM: "1"
  
  # Email
  EMAIL_PROVIDER: "smtp"
  SMTP_PORT: "587"
  SMTP_SECURE: "false"
  EMAIL_FROM_NAME: "Enterprise Auth System"
  
  # Rate Limiting
  RATE_LIMIT_AUTH_MAX: "10"
  RATE_LIMIT_AUTH_WINDOW: "60000"
  RATE_LIMIT_PASSWORD_RESET_MAX: "5"
  RATE_LIMIT_PASSWORD_RESET_WINDOW: "60000"
  RATE_LIMIT_REGISTRATION_MAX: "3"
  RATE_LIMIT_REGISTRATION_WINDOW: "300000"
  
  # Session
  SESSION_EXPIRY_DAYS: "7"
  SESSION_INACTIVE_DAYS: "30"
  SESSION_TRUST_SCORE_THRESHOLD: "50"
  
  # MFA
  MFA_TOTP_WINDOW: "1"
  MFA_BACKUP_CODES_COUNT: "10"
  MFA_CHALLENGE_EXPIRY: "300"
  
  # Security
  ACCOUNT_LOCKOUT_THRESHOLD: "5"
  ACCOUNT_LOCKOUT_DURATION: "900"
  PASSWORD_RESET_TOKEN_EXPIRY: "3600"
  EMAIL_VERIFICATION_TOKEN_EXPIRY: "86400"
  MAGIC_LINK_TOKEN_EXPIRY: "900"
  
  # CORS
  CORS_CREDENTIALS: "true"
  
  # Monitoring
  PROMETHEUS_ENABLED: "true"
  PROMETHEUS_PORT: "9090"
  OPENTELEMETRY_ENABLED: "true"
  OPENTELEMETRY_ENDPOINT: "http://otel-collector:4318"
  
  # Logging
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  LOG_FILE_ENABLED: "false"
  
  # Background Jobs
  BULLMQ_REDIS_HOST: "redis-service"
  BULLMQ_REDIS_PORT: "6379"
  BULLMQ_CONCURRENCY: "5"
  
  # Webhooks
  WEBHOOK_MAX_RETRIES: "5"
  WEBHOOK_RETRY_DELAY: "1000"
  WEBHOOK_TIMEOUT: "5000"
  
  # Feature Flags
  FEATURE_OAUTH_ENABLED: "true"
  FEATURE_MFA_ENABLED: "true"
  FEATURE_PASSWORDLESS_ENABLED: "true"
  FEATURE_WEBHOOKS_ENABLED: "true"
  FEATURE_WEBSOCKET_ENABLED: "true"
